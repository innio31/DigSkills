<!-- dashboard.html -->
<div class="dashboard-container">
  <header>
    <h1>My Learning Dashboard</h1>
    <button id="logout-btn">Log Out</button>
  </header>
  
  <div class="user-courses">
    <h2>My Enrolled Courses</h2>
    <div id="courses-list" class="courses-grid"></div>
  </div>
  
  <div class="course-materials">
    <h2>Course Materials</h2>
    <div id="materials-container"></div>
  </div>
</div>

<script>
document.getElementById('logout-btn').addEventListener('click', () => {
  netlifyIdentity.logout();
  window.location.href = '/';
});

// Fetch user's courses
async function loadUserCourses() {
  const user = netlifyIdentity.currentUser();
  const response = await fetch('/.netlify/functions/get-courses', {
    headers: {
      'Authorization': `Bearer ${user.token.access_token}`
    }
  });
  
  const courses = await response.json();
  renderCourses(courses);
}

function renderCourses(courses) {
  const container = document.getElementById('courses-list');
  courses.forEach(course => {
    container.innerHTML += `
      <div class="course-card">
        <h3>${course.name}</h3>
        <p>Enrolled on: ${new Date(course.enrolledAt).toLocaleDateString()}</p>
        <button class="access-course" data-course="${course.id}">Access Materials</button>
      </div>
    `;
  });
}

// Initialize dashboard
if (netlifyIdentity.currentUser()) {
  loadUserCourses();
} else {
  window.location.href = '/';
}
</script>
